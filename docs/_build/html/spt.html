

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Submodules &mdash; SPT 0.1.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contact" href="contact.html" />
    <link rel="prev" title="API" href="modules.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> SPT
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Submodules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spt-analytic-expressions">spt.analytic_expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spt-analyze">spt.analyze</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spt-immobile-props">spt.immobile_props</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spt-linklocs">spt.linklocs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spt-mob-props">spt.mob_props</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spt-motion-metrics">spt.motion_metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spt-special">spt.special</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SPT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">API</a> &raquo;</li>
        
      <li>Submodules</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/spt.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="submodules">
<h1>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h1>
<div class="section" id="spt-analytic-expressions">
<h2>spt.analytic_expressions<a class="headerlink" href="#spt-analytic-expressions" title="Permalink to this headline">¶</a></h2>
<p>Some analytic expressions used in other submodules, e.g. fitting functions, cdf, …</p>
<span class="target" id="module-spt.analytic_expressions"></span><dl class="py function">
<dt id="spt.analytic_expressions.ecdf">
<code class="sig-prename descclassname">spt.analytic_expressions.</code><code class="sig-name descname">ecdf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.analytic_expressions.ecdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate experimental continuous distribution function (ECDF), i.e. no binning, of random variable x
so that ECDF(value)=probability(x&gt;=value). I.e first value of counts=1.</p>
<dl class="simple">
<dt>Equivalent to inverse of:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.hist(tau_dist,bins=numpy.unique(tau_dist),normed=True,cumulative=True)</span></code>
but with non-equidistant binning, but bins are chosen according to unique values in x.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>numpy.array</em>) – 1 dimensional array of random variable</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>[0](numpy.array): Bins of ECDF corresponding to unique values of x.</p></li>
<li><p>[1](numpy.array): ECDF(value)=probability(x&gt;=value).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.analytic_expressions.exp_tracks_per_frame">
<code class="sig-prename descclassname">spt.analytic_expressions.</code><code class="sig-name descname">exp_tracks_per_frame</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.analytic_expressions.exp_tracks_per_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Exponential like decay to fit number of tracks per frame: <code class="docutils literal notranslate"><span class="pre">NoTracks=a*np.exp(-x/b)+c</span></code></p>
</dd></dl>

<dl class="py function">
<dt id="spt.analytic_expressions.gauss_1D">
<code class="sig-prename descclassname">spt.analytic_expressions.</code><code class="sig-name descname">gauss_1D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">x0</span></em>, <em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="n">A</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.analytic_expressions.gauss_1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple 1D non-normalized Gaussian function: <code class="docutils literal notranslate"><span class="pre">y=np.absolute(A)*np.exp(-(x-x0)**2/sigma**2)</span></code></p>
</dd></dl>

<dl class="py function">
<dt id="spt.analytic_expressions.gauss_Ncomb">
<code class="sig-prename descclassname">spt.analytic_expressions.</code><code class="sig-name descname">gauss_Ncomb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">N</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.analytic_expressions.gauss_Ncomb" title="Permalink to this definition">¶</a></dt>
<dd><p>Sum of N 1D Gaussian functions, see gauss_1D(x,x0,sigma,A).
The nth Gaussian function with <code class="docutils literal notranslate"><span class="pre">n</span> <span class="pre">in</span> <span class="pre">[0,N[</span></code> is:</p>
<blockquote>
<div><ul class="simple">
<li><p>centered at multiples of first Gaussian center <code class="docutils literal notranslate"><span class="pre">(n+1)*x0</span></code></p></li>
<li><p>has a width of <code class="docutils literal notranslate"><span class="pre">sqrt(n+1)*sigma</span></code> assuming Poissonian broadening</p></li>
<li><p>but decoupled Amplitudes <code class="docutils literal notranslate"><span class="pre">An</span></code></p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em>) – Values at which function is evaluated</p></li>
<li><p><strong>p</strong> (<em>list</em>) – <code class="docutils literal notranslate"><span class="pre">[x0,sigma,A0,A1,...,AN]</span></code> input parameters for sum of Gaussians (len=N+2)</p></li>
<li><p><strong>N</strong> (<em>integer</em>) – Number of Gaussian functions that are summed up</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Evaluation of function at <code class="docutils literal notranslate"><span class="pre">x</span></code>, <code class="docutils literal notranslate"><span class="pre">p</span></code>, <code class="docutils literal notranslate"><span class="pre">N</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.analytic_expressions.msd_anomal">
<code class="sig-prename descclassname">spt.analytic_expressions.</code><code class="sig-name descname">msd_anomal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tau</span></em>, <em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.analytic_expressions.msd_anomal" title="Permalink to this definition">¶</a></dt>
<dd><p>MSD fitting eq. for anomalous diffusion: <code class="docutils literal notranslate"><span class="pre">msd=a*tau**b</span></code>
According to: Carlo Manzo, Report on Progress in Physics, 78, 2015 (<a class="reference external" href="https://iopscience.iop.org/article/10.1088/0034-4885/78/12/124601">manzo</a>)</p>
</dd></dl>

<dl class="py function">
<dt id="spt.analytic_expressions.msd_free">
<code class="sig-prename descclassname">spt.analytic_expressions.</code><code class="sig-name descname">msd_free</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tau</span></em>, <em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.analytic_expressions.msd_free" title="Permalink to this definition">¶</a></dt>
<dd><p>MSD fitting eq. for simple brownian diffusion taking localization precision into account: <code class="docutils literal notranslate"><span class="pre">msd=a*tau+b</span></code>
According to: Xavier Michalet, Physical Review E, 82, 2010 (<a class="reference external" href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.82.041914">michalet</a>)</p>
</dd></dl>

</div>
<div class="section" id="spt-analyze">
<h2>spt.analyze<a class="headerlink" href="#spt-analyze" title="Permalink to this headline">¶</a></h2>
<p>Further evaluate (averaging, …) _tprops. or _tmobprops.hdf5 files, i.e. to generate end result of kinetic analysis.</p>
<span class="target" id="module-spt.analyze"></span><dl class="py function">
<dt id="spt.analyze.fit_Ncomb">
<code class="sig-prename descclassname">spt.analyze.</code><code class="sig-name descname">fit_Ncomb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">centers_init</span></em>, <em class="sig-param"><span class="n">N</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.analyze.fit_Ncomb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="spt.analyze.fit_levels">
<code class="sig-prename descclassname">spt.analyze.</code><code class="sig-name descname">fit_levels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">centers_init</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.analyze.fit_levels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="spt.analyze.fit_tracks_per_frame">
<code class="sig-prename descclassname">spt.analyze.</code><code class="sig-name descname">fit_tracks_per_frame</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_tracks</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.analyze.fit_tracks_per_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit number of trajectories per frame with deaying exponential</p>
</dd></dl>

<dl class="py function">
<dt id="spt.analyze.get_NgT">
<code class="sig-prename descclassname">spt.analyze.</code><code class="sig-name descname">get_NgT</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.analyze.get_NgT" title="Permalink to this definition">¶</a></dt>
<dd><p>Return average and 25%/75% interquartile range of all NgT related values.</p>
</dd></dl>

<dl class="py function">
<dt id="spt.analyze.get_T_with_N">
<code class="sig-prename descclassname">spt.analyze.</code><code class="sig-name descname">get_T_with_N</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.analyze.get_T_with_N" title="Permalink to this definition">¶</a></dt>
<dd><p>Return critical times of NgT</p>
</dd></dl>

<dl class="py function">
<dt id="spt.analyze.get_half_time">
<code class="sig-prename descclassname">spt.analyze.</code><code class="sig-name descname">get_half_time</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.analyze.get_half_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Get half life time, i.e. 1-ecdf (means bigger than T) of start times for different ignore values.</p>
</dd></dl>

<dl class="py function">
<dt id="spt.analyze.get_mobile_props">
<code class="sig-prename descclassname">spt.analyze.</code><code class="sig-name descname">get_mobile_props</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df_in</span></em>, <em class="sig-param"><span class="n">infos</span></em>, <em class="sig-param"><span class="n">px</span></em>, <em class="sig-param"><span class="n">CycleTime</span></em>, <em class="sig-param"><span class="n">remove_immob</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.analyze.get_mobile_props" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="spt.analyze.get_props">
<code class="sig-prename descclassname">spt.analyze.</code><code class="sig-name descname">get_props</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.analyze.get_props" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Wrapper function to combine:</dt><dd><ul class="simple">
<li><p>get_half_time(df)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.analyze.get_result">
<code class="sig-prename descclassname">spt.analyze.</code><code class="sig-name descname">get_result</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.analyze.get_result" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="spt.analyze.tracks_per_frame">
<code class="sig-prename descclassname">spt.analyze.</code><code class="sig-name descname">tracks_per_frame</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">props</span></em>, <em class="sig-param"><span class="n">NoFrames</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.analyze.tracks_per_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Count number of trajectories per frame.</p>
</dd></dl>

</div>
<div class="section" id="spt-immobile-props">
<h2>spt.immobile_props<a class="headerlink" href="#spt-immobile-props" title="Permalink to this headline">¶</a></h2>
<p>Kinetic properties of picks for immobilized samples, e.g. TPP, photons, binding events, …</p>
<span class="target" id="module-spt.immobile_props"></span><dl class="py function">
<dt id="spt.immobile_props.apply_props">
<code class="sig-prename descclassname">spt.immobile_props.</code><code class="sig-name descname">apply_props</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">ignore</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.immobile_props.apply_props" title="Permalink to this definition">¶</a></dt>
<dd><p>Group _picked.hdf5 by groups (i.e. picks in <a class="reference external" href="https://picasso-addon.readthedocs.io/en/latest/howto.html#autopick">picasso.addon</a>) and
apply get_props() to each group to get immobile properties as in <a class="reference external" href="https://www.biorxiv.org/content/10.1101/2020.05.17.100354v1">spt</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Grouped localization list, i.e. _picked.hdf5 as in <a class="reference external" href="https://picasso-addon.readthedocs.io/en/latest/howto.html#autopick">picasso.addon</a></p></li>
<li><p><strong>ignore</strong> (<em>int=1</em>) – Maximum interruption (frames) allowed to be regarded as one bright time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Output of get_props() for each group in <code class="docutils literal notranslate"><span class="pre">df</span></code> (groupby-apply approach).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.immobile_props.apply_props_dask">
<code class="sig-prename descclassname">spt.immobile_props.</code><code class="sig-name descname">apply_props_dask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">ignore</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.immobile_props.apply_props_dask" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as apply_props() but in parallelized version using DASK by partitioning df.
Local DASK cluster has to be started manually for efficient computation, see cluster_setup_howto().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Grouped localization list, i.e. _picked.hdf5 as in <a class="reference external" href="https://picasso-addon.readthedocs.io/en/latest/howto.html#autopick">picasso.addon</a></p></li>
<li><p><strong>ignore</strong> (<em>int=1</em>) – Maximum interruption (frames) allowed to be regarded as one bright time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Output of get_props() for each group in <code class="docutils literal notranslate"><span class="pre">df</span></code> (groupby-apply approach).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.immobile_props.cluster_setup_howto">
<code class="sig-prename descclassname">spt.immobile_props.</code><code class="sig-name descname">cluster_setup_howto</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#spt.immobile_props.cluster_setup_howto" title="Permalink to this definition">¶</a></dt>
<dd><p>Print instruction howto start a DASK local cluster for efficient computation of apply_props_dask().
Fixed <code class="docutils literal notranslate"><span class="pre">scheduler_port=8787</span></code> is used to easily reconnect to cluster once it was started.</p>
</dd></dl>

<dl class="py function">
<dt id="spt.immobile_props.filter_">
<code class="sig-prename descclassname">spt.immobile_props.</code><code class="sig-name descname">filter_</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">NoFrames</span></em>, <em class="sig-param"><span class="n">apply_filter</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.immobile_props.filter_" title="Permalink to this definition">¶</a></dt>
<dd><p>Decide which filter to apply to the output of get_props(), either:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘sd’ as given by filter_fix()</p></li>
<li><p>‘th’ as given by filter_nofix()</p></li>
<li><p>‘none’ if no filter should be applied</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Immobile properties as calulated by apply_props()</p></li>
<li><p><strong>NoFrames</strong> (<em>int</em>) – Length of measurement in frames of corresponding raw movie.</p></li>
<li><p><strong>apply_filter</strong> (<em>str</em>) – Either ‘sd’,’th’ or ‘none’. See above.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Positives in <code class="docutils literal notranslate"><span class="pre">df</span></code> according to chosen filter as described above.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.immobile_props.filter_fix">
<code class="sig-prename descclassname">spt.immobile_props.</code><code class="sig-name descname">filter_fix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.immobile_props.filter_fix" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter for immobilized single dye origami as described in <a class="reference external" href="https://www.biorxiv.org/content/10.1101/2020.05.17.100354v1">spt</a>.
Positives are groups</p>
<blockquote>
<div><ul class="simple">
<li><p>with a trajectory within the first 5 frames after the start of the measurement</p></li>
<li><p>and number of trajectories within group lie in 90% interval of all groups</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Immobile properties as calulated by apply_props()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Positives in <code class="docutils literal notranslate"><span class="pre">df</span></code> according to single dye filter as described above.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.immobile_props.filter_nofix">
<code class="sig-prename descclassname">spt.immobile_props.</code><code class="sig-name descname">filter_nofix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">NoFrames</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.immobile_props.filter_nofix" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter for immobilized origami with DNA-PAINT based tracking handle (TH) as described in <a class="reference external" href="https://www.biorxiv.org/content/10.1101/2020.05.17.100354v1">spt</a>.
Positives are groups</p>
<blockquote>
<div><ul class="simple">
<li><p>with a trajectory within the first 5 frames after the start of the measurement</p></li>
<li><p>and number localizations within group are greater or equal to 20% of total measurement duration (in frames)</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Immobile properties as calulated by apply_props()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Positives in <code class="docutils literal notranslate"><span class="pre">df</span></code> according to TH filter as described above.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.immobile_props.get_NgT">
<code class="sig-prename descclassname">spt.immobile_props.</code><code class="sig-name descname">get_NgT</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">ignore</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.immobile_props.get_NgT" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine get_taubs() and tracks_greaterT() to return TPP as pd.Series for one group.</p>
<blockquote>
<div><ul class="simple">
<li><p>Input equivalent to get_taubs().</p></li>
<li><p>Output equivalent to tracks_greaterT()[0].</p></li>
</ul>
</div></blockquote>
<p>The function assumes that there is only one group in the localization list!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Grouped localization list, i.e._picked.hdf5 as in <a class="reference external" href="https://picasso-addon.readthedocs.io/en/latest/howto.html#autopick">picasso.addon</a></p></li>
<li><p><strong>ignore</strong> (<em>int=1</em>) – Maximum interruption (frames) allowed to be regarded as one bright time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Index consists of a combination of one of the following letters and T in frames.</p>
<ul class="simple">
<li><p>n: Number of tracks longer or equal to T, i.e. TPP as in <a class="reference external" href="https://www.biorxiv.org/content/10.1101/2020.05.17.100354v1">spt</a></p></li>
<li><p>s: Mean 1st frame of tracks longer or equal to T.</p></li>
<li><p>p: Mean photons of tracks longer or equal to T.</p></li>
<li><p>e: Mean relative standard deviation of photons of tracks longer or equal to T.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.immobile_props.get_props">
<code class="sig-prename descclassname">spt.immobile_props.</code><code class="sig-name descname">get_props</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">ignore</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.immobile_props.get_props" title="Permalink to this definition">¶</a></dt>
<dd><p>Combination of get_NgT(df,ignore) and get_start(df,ignore) and get_var(df).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Grouped localization list, i.e. _picked.hdf5 as in <a class="reference external" href="https://picasso-addon.readthedocs.io/en/latest/howto.html#autopick">picasso.addon</a></p></li>
<li><p><strong>ignore</strong> (<em>int=1</em>) – Maximum interruption (frames) allowed to be regarded as one bright time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Concatenated output of get_NgT(df,ignore) and get_start(df,ignore) and get_var(df).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.immobile_props.get_start">
<code class="sig-prename descclassname">spt.immobile_props.</code><code class="sig-name descname">get_start</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">ignore</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.immobile_props.get_start" title="Permalink to this definition">¶</a></dt>
<dd><p>For a list of <code class="docutils literal notranslate"><span class="pre">ignore</span></code> values, was there a bright time at the start of the measurement and of which duration?
That means for</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ignore=2</span></code> and the first bright time starting at frame=3 there was NO bright time</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignore=3</span></code> and the first bright time starting at frame=3 there was a bright time of finite duration.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Grouped localization list, i.e. _picked.hdf5 as in <a class="reference external" href="https://picasso-addon.readthedocs.io/en/latest/howto.html#autopick">picasso.addon</a></p></li>
<li><p><strong>ignore</strong> (<em>list</em>) – List of maximum interruption (frames) allowed to be regarded as one bright time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Index has format <code class="docutils literal notranslate"><span class="pre">Tstart-i%i'%(ignore)</span></code>.
The value is the duration of the bright time at start of measurement if it happened within <code class="docutils literal notranslate"><span class="pre">ignore</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.immobile_props.get_taubs">
<code class="sig-prename descclassname">spt.immobile_props.</code><code class="sig-name descname">get_taubs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">ignore</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.immobile_props.get_taubs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get bright time distribution, i.e. the intervals of continuous localizations only interrupted
by <code class="docutils literal notranslate"><span class="pre">ignore</span></code> for one group and additional properties of each bright time. I.e. a bright time
corresponds to one trajectory in terms of single particle tracking. The function assumes
that there is only one group in the localization list!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Grouped localization list, i.e._picked.hdf5 as in <a class="reference external" href="https://picasso-addon.readthedocs.io/en/latest/howto.html#autopick">picasso.addon</a></p></li>
<li><p><strong>ignore</strong> (<em>int=1</em>) – Maximum interruption (frames) allowed to be regarded as one bright time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>[0](numpy.array): Bright times only interrupted by <code class="docutils literal notranslate"><span class="pre">ignore</span></code></p></li>
<li><p>[1](numpy.array): 1st frame of each bright time</p></li>
<li><p>[2](numpy.array): Mean photon values of each bright time</p></li>
<li><p>[3](numpy.array): Relative standard deviation of photons of each bright time</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.immobile_props.get_trace">
<code class="sig-prename descclassname">spt.immobile_props.</code><code class="sig-name descname">get_trace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">NoFrames</span></em>, <em class="sig-param"><span class="n">field</span><span class="o">=</span><span class="default_value">'net_gradient'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.immobile_props.get_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Get continuous field vs. time trace of length=NoFrames for one group. The function assumes that
there is only one group in the localization list!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Grouped localization list, i.e. _picked.hdf5 as in <a class="reference external" href="https://picasso-addon.readthedocs.io/en/latest/howto.html#autopick">picasso.addon</a></p></li>
<li><p><strong>NoFrames</strong> (<em>int</em>) – Length of measurement in frames of corresponding raw movie.</p></li>
<li><p><strong>field</strong> (<em>str</em>) – Column name in df, e.g. ‘photons’ for intensity vs. time trace.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Trace, e.g. continuous field vs. time trace of length=NoFrames for one group</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.immobile_props.get_var">
<code class="sig-prename descclassname">spt.immobile_props.</code><code class="sig-name descname">get_var</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.immobile_props.get_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Get various properties for one group in _picked.hdf5 as in <a class="reference external" href="https://picasso-addon.readthedocs.io/en/latest/howto.html#autopick">picasso.addon</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Grouped localization list, i.e. _picked.hdf5 as in <a class="reference external" href="https://picasso-addon.readthedocs.io/en/latest/howto.html#autopick">picasso.addon</a></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Indices are means of all columns in <code class="docutils literal notranslate"><span class="pre">df</span></code> plus …</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n_locs</span></code>:      Number of localizations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">photons</span></code>:     Not mean but median!</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">std_photons</span></code>: Standard deviation of photons.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bg</span></code>:          Background photons. Not mean but median!</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sx</span></code>:          Standard deviation of group in <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sy</span></code>:          Standard deviation of group in <code class="docutils literal notranslate"><span class="pre">y</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min_frame</span></code>:   Mimimum in frames</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_frame</span></code>:   Maximum in frames</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">len</span></code>:         max_frame-min_frame (see above)</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.immobile_props.main">
<code class="sig-prename descclassname">spt.immobile_props.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">locs</span></em>, <em class="sig-param"><span class="n">info</span></em>, <em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.immobile_props.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Get immobile properties for each group in _picked.hdf5 file (see <a class="reference external" href="https://picasso-addon.readthedocs.io/en/latest/howto.html#autopick">picasso.addon</a>) and filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>locs</strong> (<em>pandas.DataFrame</em>) – Grouped localization list, i.e. _picked.hdf5 as in <a class="reference external" href="https://picasso-addon.readthedocs.io/en/latest/howto.html#autopick">picasso.addon</a></p></li>
<li><p><strong>info</strong> (<em>list</em>) – Info _picked.yaml to _picked.hdf5 localizations as list of dictionaries.</p></li>
<li><p><strong>path</strong> (<em>str</em>) – Path to _picked.hdf5 file.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ignore</strong> (<em>int=1</em>) – Maximum interruption (frames) allowed to be regarded as one bright time.</p></li>
<li><p><strong>parallel</strong> (<em>bool=True</em>) – Apply parallel computing using DASK? Local cluster should be started before according to cluster_setup_howto()</p></li>
<li><p><strong>filter</strong> (<em>string='th'</em>) – Which filter to use, either None, ‘th’ or ‘sd’ or ‘none’</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>[0](dict):             Dict of keyword arguments passed to function.</p></li>
<li><p>[1](pandas.DataFrame): Immobile properties of each group in <code class="docutils literal notranslate"><span class="pre">locs</span></code> as calulated by apply_props()</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.immobile_props.tracks_greaterT">
<code class="sig-prename descclassname">spt.immobile_props.</code><code class="sig-name descname">tracks_greaterT</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">track_length</span></em>, <em class="sig-param"><span class="n">track_start</span></em>, <em class="sig-param"><span class="n">track_photons</span></em>, <em class="sig-param"><span class="n">track_photons_std</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.immobile_props.tracks_greaterT" title="Permalink to this definition">¶</a></dt>
<dd><p>Get number of trajectories (bright times) per particle (group or pick) greater or equal to T, i.e. TPP in <a class="reference external" href="https://www.biorxiv.org/content/10.1101/2020.05.17.100354v1">spt</a>.
The function takes returns of get_taubs() as input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>track_length</strong> (<em>numpy.array</em>) – Trajectory durations or bright times only interrupted by <code class="docutils literal notranslate"><span class="pre">ignore</span></code>. See get_taubs().</p></li>
<li><p><strong>track_start</strong> (<em>numpy.array</em>) – 1st frame of each trajectory. See get_taubs().</p></li>
<li><p><strong>track_photons</strong> (<em>numpy.array</em>) – Mean photon values of each bright time. See get_taubs().</p></li>
<li><p><strong>track_photons_std</strong> (<em>numpy.array</em>) – Relative standard deviation of photons of each bright time. See get_taubs().</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p>[0](pandas.Series): Index consists of a combination of one of the following letters and T in frames.</p>
<blockquote>
<div><ul class="simple">
<li><p>n: Number of tracks longer or equal to T, i.e. TPP as in <a class="reference external" href="https://www.biorxiv.org/content/10.1101/2020.05.17.100354v1">spt</a></p></li>
<li><p>s: Mean 1st frame of tracks longer or equal to T.</p></li>
<li><p>p: Mean photons of tracks longer or equal to T.</p></li>
<li><p>e: Mean relative standard deviation of photons of tracks longer or equal to T.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>[1](numpy.array): T in frames</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="spt-linklocs">
<h2>spt.linklocs<a class="headerlink" href="#spt-linklocs" title="Permalink to this headline">¶</a></h2>
<p>Linking of localizations into particle trajectories using <a class="reference external" href="http://soft-matter.github.io/trackpy/v0.4.2/">trackpy</a>.</p>
<span class="target" id="module-spt.linklocs"></span><dl class="py function">
<dt id="spt.linklocs.drop_shorttracks">
<code class="sig-prename descclassname">spt.linklocs.</code><code class="sig-name descname">drop_shorttracks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">crit_len</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.linklocs.drop_shorttracks" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove trajectories shorter than crit_len from output of get_link().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Trajectories pandas.DataFrame, i.e. output of get_link() (see also trackpy.link())</p></li>
<li><p><strong>crit_len</strong> (<em>int=10</em>) – Trajectories having less localizations than crit_len (frames) will be removed from df</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">df</span></code> with short trajectories &lt; crit_len removed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.linklocs.get_link">
<code class="sig-prename descclassname">spt.linklocs.</code><code class="sig-name descname">get_link</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">locs</span></em>, <em class="sig-param"><span class="n">search_range</span></em>, <em class="sig-param"><span class="n">memory</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.linklocs.get_link" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply trackpy.link_df() (<a class="reference external" href="http://soft-matter.github.io/trackpy/v0.4.2/">trackpy</a>) on localizations with given search_range and memory to get trajectories sorted by group and frame.
All tracks shorter or equal to 10 frames are removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>locs</strong> (<em>pandas.DataFrame</em>) – Localizations as generated by <a class="reference external" href="https://picassosr.readthedocs.io/en/latest/localize.html">picasso.localize</a>  as pandas.DataFrame</p></li>
<li><p><strong>info</strong> (<em>picasso.io</em>) – Info _locs.yaml to _locs.hdf5 localizations as list of dictionaries.</p></li>
<li><p><strong>search_range</strong> (<em>int</em>) – Localizations within search_range (spatial) will be connected to tracks (see trackpy.link_df)</p></li>
<li><p><strong>memory</strong> (<em>int</em>) – Localizations within memory (temporal) will be connected to tracks (see trackpy.link_df)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Linked trajectories using trackpy.link().</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> instead of <code class="docutils literal notranslate"><span class="pre">particle</span></code> column for <a class="reference external" href="https://picassosr.readthedocs.io/en/latest/render.html">picasso.render</a> compatibility.</p></li>
<li><p>All trajectories with &lt;= 10 localizations are already removed!!</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.linklocs.main">
<code class="sig-prename descclassname">spt.linklocs.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">locs</span></em>, <em class="sig-param"><span class="n">info</span></em>, <em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.linklocs.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Link localizations using trackpy.link_df() (<a class="reference external" href="http://soft-matter.github.io/trackpy/v0.4.2/">trackpy</a>) on localizations (<a class="reference external" href="https://picassosr.readthedocs.io/en/latest/localize.html">picasso.localize</a>) with given search_range and
memory to get trajectories sorted by group and frame. All tracks shorter or equal to 10 frames are removed. Trajectories
will be saved as <code class="docutils literal notranslate"><span class="pre">'_picked%i%i.hdf5'%(search_range,memory)</span></code> with corresponding info as .yaml.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>locs</strong> (<em>pandas.DataFrame</em>) – Localization list, i.e. _locs.hdf5 as in <a class="reference external" href="https://picassosr.readthedocs.io/en/latest/localize.html">picasso.localize</a></p></li>
<li><p><strong>info</strong> (<em>list</em>) – Info _locs.yaml to _locs.hdf5 localizations as list of dictionaries.</p></li>
<li><p><strong>path</strong> (<em>str</em>) – Path to _locs.hdf5 file.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>search_range</strong> (<em>int</em>) – Localizations within search_range (spatial) will be connected to tracks (see trackpy.link_df)</p></li>
<li><p><strong>memory</strong> (<em>int</em>) – Localizations within memory (temporal) will be connected to tracks (see trackpy.link_df)</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>[0](dict):             Dict of keyword arguments passed to function.</p></li>
<li><p>[1](pandas.DataFrame): Trajectories by application of trackpy.link_df(). See above.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.linklocs.plot_scan_results">
<code class="sig-prename descclassname">spt.linklocs.</code><code class="sig-name descname">plot_scan_results</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">prox</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.linklocs.plot_scan_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Quickly plot results in scan_sr_mem().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Return DataFrame of scan_sr_mem()[0].</p></li>
<li><p><strong>prox</strong> (<em>float</em>) – Return DataFrame of scan_sr_mem()[1].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.linklocs.scan_sr_mem">
<code class="sig-prename descclassname">spt.linklocs.</code><code class="sig-name descname">scan_sr_mem</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">locs</span></em>, <em class="sig-param"><span class="n">info</span></em>, <em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">sr</span></em>, <em class="sig-param"><span class="n">mem</span></em>, <em class="sig-param"><span class="n">roi</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">timewindow</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.linklocs.scan_sr_mem" title="Permalink to this definition">¶</a></dt>
<dd><p>Quick scan using get_link() (<a class="reference external" href="http://soft-matter.github.io/trackpy/v0.4.2/">trackpy</a>) algorithm using tuples of <code class="docutils literal notranslate"><span class="pre">search_ranges</span></code> and <code class="docutils literal notranslate"><span class="pre">memory</span></code>
over center ROI and starting time window of the video. Corresponding plot will be saved using plot_scan_results().
This is implemented in order to quickly estimate optimum linking parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>locs</strong> (<em>pandas.DataFrame</em>) – Localizations as generated by <a class="reference external" href="https://picassosr.readthedocs.io/en/latest/localize.html">picasso.localize</a>  as pandas.DataFrame</p></li>
<li><p><strong>info</strong> (<em>picasso.io</em>) – Info _locs.yaml to _locs.hdf5 localizations as list of dictionaries.</p></li>
<li><p><strong>path</strong> (<em>str</em>) – Path to _locs.hdf5 file for saving output</p></li>
<li><p><strong>sr</strong> (<em>list</em><em>(</em><em>int</em><em>)</em>) – List of search_ranges to scan (see trackpy.link)</p></li>
<li><p><strong>mem</strong> (<em>list</em><em>(</em><em>int</em><em>)</em>) – List of memory values to scan  (see trackpy.link)</p></li>
<li><p><strong>roi</strong> (<em>bool=True</em>) – If True scan is performed on cropped video to <strong>center 200^2 px</strong> FOV</p></li>
<li><p><strong>timewindow</strong> (<em>bool=True</em>) – If True scan is performed on first <strong>300 frames</strong> of video only</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p>[0] (pandas.DataFrame): Multi-Index: Tuple (<code class="docutils literal notranslate"><span class="pre">search_range</span></code>, <code class="docutils literal notranslate"><span class="pre">memory</span></code>) with columns:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">len_med</span></code>: Median track length</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numtracks</span></code>: Number of linked tracks</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">search_range</span></code>: See above</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">memory</span></code>: See above</p></li>
</ul>
</div></blockquote>
</li>
<li><p>[1] (float):</p>
<blockquote>
<div><p>Proximity, i.e. 90% of all nearest neighbor distances between localizations
corresponding to first 100 frames (full FOV) are greater than proximity (px).</p>
</div></blockquote>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="spt-mob-props">
<h2>spt.mob_props<a class="headerlink" href="#spt-mob-props" title="Permalink to this headline">¶</a></h2>
<p>Kinetic properties of trajectories for of mobile samples, e.g. MSD caluclation and fitting, …</p>
<span class="target" id="module-spt.mob_props"></span><dl class="py function">
<dt id="spt.mob_props.apply_props">
<code class="sig-prename descclassname">spt.mob_props.</code><code class="sig-name descname">apply_props</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.mob_props.apply_props" title="Permalink to this definition">¶</a></dt>
<dd><p>Group trajectories list (_pickedxxxx.hdf5) as obtained by linklocs.main() by groups (i.e. trajectories) and
apply get_props() to each group to get mobile properties. See also <a class="reference external" href="https://www.biorxiv.org/content/10.1101/2020.05.17.100354v1">spt</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Trajectories list (_pickedxxxx.hdf5) as obtained by linklocs.main()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Output of get_props() for each group in <code class="docutils literal notranslate"><span class="pre">df</span></code> (groupby-apply approach).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.mob_props.apply_props_dask">
<code class="sig-prename descclassname">spt.mob_props.</code><code class="sig-name descname">apply_props_dask</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.mob_props.apply_props_dask" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as apply_props() but in parallelized version using DASK by partitioning df.
Local DASK cluster has to be started manually for efficient computation, see cluster_setup_howto().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Trajectories list (_pickedxxxx.hdf5) as obtained by linklocs.main()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Output of get_props() for each group in <code class="docutils literal notranslate"><span class="pre">df</span></code> (groupby-apply approach).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.mob_props.fit_msd_anomal">
<code class="sig-prename descclassname">spt.mob_props.</code><code class="sig-name descname">fit_msd_anomal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lagtimes</span></em>, <em class="sig-param"><span class="n">msd</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.mob_props.fit_msd_anomal" title="Permalink to this definition">¶</a></dt>
<dd><p>Unweighted least square fit of invidual msd by anomalous model <code class="docutils literal notranslate"><span class="pre">msd=a*lagtimes**b</span></code>,
see analytic_expressions.msd_anomal(). If there was less then two data-points or fit was not succesfull
NaNs are returned as optimum parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lagtimes</strong> (<em>np.array</em>) – Array of msd lagtimes</p></li>
<li><p><strong>msd</strong> (<em>np.array</em>) – Mean square displacement (msd) at lagtimes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Column <code class="docutils literal notranslate"><span class="pre">a</span></code> corresponds to slope, <code class="docutils literal notranslate"><span class="pre">b</span></code> corresponds to diffusion mode.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.mob_props.fit_msd_free">
<code class="sig-prename descclassname">spt.mob_props.</code><code class="sig-name descname">fit_msd_free</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lagtimes</span></em>, <em class="sig-param"><span class="n">msd</span></em>, <em class="sig-param"><span class="n">offset</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.mob_props.fit_msd_free" title="Permalink to this definition">¶</a></dt>
<dd><p>Unweighted least square fit of invidual msd by linear model <code class="docutils literal notranslate"><span class="pre">msd=a*lagtimes+b</span></code>, see analytic_expressions.msd_free(),
i.e. assuming free Browninan motion. If there was less then two data-points or fit was not succesfull
NaNs are returned as optimum parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lagtimes</strong> (<em>np.array</em>) – Array of msd lagtimes</p></li>
<li><p><strong>msd</strong> (<em>np.array</em>) – Mean square displacement (msd) at lagtimes</p></li>
<li><p><strong>offset</strong> (<em>bool=False</em>) – If True offset is used in linear fit model, if False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Column <code class="docutils literal notranslate"><span class="pre">a</span></code> corresponds to slope, <code class="docutils literal notranslate"><span class="pre">b</span></code> corresponds to offset of linear function applied.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.mob_props.fit_msd_free_iterative">
<code class="sig-prename descclassname">spt.mob_props.</code><code class="sig-name descname">fit_msd_free_iterative</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lagtimes</span></em>, <em class="sig-param"><span class="n">msd</span></em>, <em class="sig-param"><span class="n">max_it</span><span class="o">=</span><span class="default_value">5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.mob_props.fit_msd_free_iterative" title="Permalink to this definition">¶</a></dt>
<dd><p>Unweighted least square fit of invidual msd by linear model <code class="docutils literal notranslate"><span class="pre">msd=a*lagtimes+b</span></code> in <strong>iterative manner</strong>
to find optimum fitting range of msd according to: Xavier Michalet, Physical Review E, 82, 2010 (<a class="reference external" href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.82.041914">michalet</a>).
In first iteration msd is fitted up to a maximum lagtime of <code class="docutils literal notranslate"><span class="pre">lag_max=0.5*Nmsd</span></code> with <code class="docutils literal notranslate"><span class="pre">Nmsd</span></code> being the full msd length.
Notice that motion_metrics.displacement_moments() calculates msd only up to <code class="docutils literal notranslate"><span class="pre">Nmsd=0.25*N</span></code> hence <code class="docutils literal notranslate"><span class="pre">lag_max=0.125*N</span></code>
with Nbeing the full lenght of the trajectory. Then fitting range is updated according to rule
<code class="docutils literal notranslate"><span class="pre">lag_max=int(np.round(2+2.3*(b/a)**0.52))</span></code>. For a detailed illustration please see SI of <a class="reference external" href="https://www.biorxiv.org/content/10.1101/2020.05.17.100354v1">spt</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lagtimes</strong> (<em>np.array</em>) – Array of msd lagtimes</p></li>
<li><p><strong>msd</strong> (<em>np.array</em>) – Mean square displacement (msd) at lagtimes</p></li>
<li><p><strong>max_it</strong> (<em>int=5</em>) – Maximum number of iterations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> slope  of linear function applied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> offset of linear function applied</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> maximum lagtime up to which msd was fitted</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_it</span></code> resulting number of iterations until convergence was achieved</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.mob_props.get_props">
<code class="sig-prename descclassname">spt.mob_props.</code><code class="sig-name descname">get_props</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.mob_props.get_props" title="Permalink to this definition">¶</a></dt>
<dd><p>Combination of immobile_props.get_var(df) and getfit_moments(df).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Trajectories (_pickedxxxx.hdf5) as obtained by linklocs.main()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Concatenated output of immobile_props.get_var(df) and getfit_moments(df).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.mob_props.getfit_moments">
<code class="sig-prename descclassname">spt.mob_props.</code><code class="sig-name descname">getfit_moments</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.mob_props.getfit_moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate msd of single trajectory using metrics.displacement_moments() and apply both linear iterative fitting
according to fit_msd_free_iterative() and anomlaous diffsuion model fitting using fit_msd_anomal() to msd.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Trajectories (_pickedxxxx.hdf5) as obtained by linklocs.main()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Concatenated output of fit_msd_free_iterative() and fit_msd_anomal().</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a_iter</span></code> slope  of iterative linear fit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b_iter</span></code> offset of iterative linear fit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p_iter</span></code> maximum lagtime up to which msd was fitted for iterative linear fit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_iter</span></code> resulting number of iterations until convergence was achieved for iterative linear fit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> slope of anomalous fit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> diffusion mode of anomalous fit</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.mob_props.main">
<code class="sig-prename descclassname">spt.mob_props.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">locs</span></em>, <em class="sig-param"><span class="n">info</span></em>, <em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.mob_props.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Get mobile properties for each group in trajectories list (_pickedxxxx.hdf5) file as obtained by linklocs.main().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>locs</strong> (<em>pandas.DataFrame</em>) – Trajectories list (_pickedxxxx.hdf5) as obtained by linklocs.main()</p></li>
<li><p><strong>info</strong> (<em>list</em>) – Info _pickedxxxx.yaml to _pickedxxxx.hdf5 trajectories as list of dictionaries.</p></li>
<li><p><strong>path</strong> (<em>str</em>) – Path to _pickedxxxx.hdf5 file.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><p><strong>parallel</strong> (<em>bool=True</em>) – Apply parallel computing using DASK? Local cluster should be started before according to cluster_setup_howto()</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>[0](dict):             Dict of keyword arguments passed to function.</p></li>
<li><p>[1](pandas.DataFrame): Mobile properties of each group in <code class="docutils literal notranslate"><span class="pre">locs</span></code> as calulated by apply_props()</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="spt-motion-metrics">
<h2>spt.motion_metrics<a class="headerlink" href="#spt-motion-metrics" title="Permalink to this headline">¶</a></h2>
<p>Numba optimized caluclation of motion metrics like MSD, MME, straightness, msd_ratio, …</p>
<span class="target" id="module-spt.motion_metrics"></span><dl class="py function">
<dt id="spt.motion_metrics.displacement_moments">
<code class="sig-prename descclassname">spt.motion_metrics.</code><code class="sig-name descname">displacement_moments</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.motion_metrics.displacement_moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Numba optimized calulation of trajectory <code class="docutils literal notranslate"><span class="pre">(t,x,y)</span></code> moments. Calulation accounts for short gaps, i.e. missed localizations
recovered by allowed <code class="docutils literal notranslate"><span class="pre">memory</span></code> values. Moments are only calulated up to maximum lag time of <code class="docutils literal notranslate"><span class="pre">l_max</span> <span class="pre">=</span> <span class="pre">0.25*N</span></code> with <code class="docutils literal notranslate"><span class="pre">N=len(t)</span></code>.
Calulated moments are:</p>
<blockquote>
<div><ul class="simple">
<li><p>Mean square displacement (MSD)</p></li>
<li><p>Mean displacement moment of 4th order (MSD corresponds to 2nd order)</p></li>
<li><p>Mean maximal excursion of 2nd order (MME)</p></li>
<li><p>Mean maximal excursion of 4th order</p></li>
</ul>
</div></blockquote>
<p>MME is calculated according to: Vincent Tejedor, Biophysical Journal, 98, 7, 2010 (<a class="reference external" href="https://www.cell.com/biophysj/fulltext/S0006-3495(09)06097-4">tejedor</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>np.array</em>) – time</p></li>
<li><p><strong>x</strong> (<em>np.array</em>) – x-position</p></li>
<li><p><strong>y</strong> (<em>np.array</em>) – y-position</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[:,0]</span></code>: lag time</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[:,1]</span></code>: MSD</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[:,2]</span></code>: Mean displacement moment of 4th order</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[:,3]</span></code>: MME</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[:,4]</span></code>: Mean maximal excursion of 4th order</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array of size <code class="docutils literal notranslate"><span class="pre">(l_max,5)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.motion_metrics.msd_ratio">
<code class="sig-prename descclassname">spt.motion_metrics.</code><code class="sig-name descname">msd_ratio</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">moments</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.motion_metrics.msd_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>MSD ratio (classifier H.) according to P. Kowalek, Physical Review E, 100, 2019 (<a class="reference external" href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.100.032410">kowalek</a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>moments</strong> (<em>np.array</em>) – Return of displacement_moments(t,x,y)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>MSD ratio</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.motion_metrics.straightness">
<code class="sig-prename descclassname">spt.motion_metrics.</code><code class="sig-name descname">straightness</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.motion_metrics.straightness" title="Permalink to this definition">¶</a></dt>
<dd><p>Straightness (classifier I.) according to P. Kowalek, Physical Review E, 100, 2019 (<a class="reference external" href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.100.032410">kowalek</a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em>) – x-positions of trajectory</p></li>
<li><p><strong>y</strong> (<em>np.array</em>) – y-positions of trajectory</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Straightness</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="spt-special">
<h2>spt.special<a class="headerlink" href="#spt-special" title="Permalink to this headline">¶</a></h2>
<p>Some special functions, e.g. track splitting into subtrajectories, generation of track and diffusion maps, …</p>
<span class="target" id="module-spt.special"></span><dl class="py function">
<dt id="spt.special.assign_prop_to_picked">
<code class="sig-prename descclassname">spt.special.</code><code class="sig-name descname">assign_prop_to_picked</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">props</span></em>, <em class="sig-param"><span class="n">picked</span></em>, <em class="sig-param"><span class="n">field</span><span class="o">=</span><span class="default_value">'a_iter'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.special.assign_prop_to_picked" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="spt.special.assign_subgroup">
<code class="sig-prename descclassname">spt.special.</code><code class="sig-name descname">assign_subgroup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">subN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.special.assign_subgroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Renames group colum into supgroup and and assigns new column subgroup.
Each subgroup splits the supgroup in chunks of subN, i.e. splitting of trajectories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Picked localizations (see picasso.render)</p></li>
<li><p><strong>subN</strong> (<em>int</em>) – Maximum length of sub-trajectories</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Picked localizations (see picasso.render) with one new (subgroup)</dt><dd><p>and one modified column (supgroup = group of original). See also above.              :</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>subdf(pandas.DataFrame)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="spt.special.get_trackmap">
<code class="sig-prename descclassname">spt.special.</code><code class="sig-name descname">get_trackmap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">locs</span></em>, <em class="sig-param"><span class="n">fov</span></em>, <em class="sig-param"><span class="n">oversampling</span></em>, <em class="sig-param"><span class="n">field</span><span class="o">=</span><span class="default_value">'assign_field'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.special.get_trackmap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="spt.special.pair_ids">
<code class="sig-prename descclassname">spt.special.</code><code class="sig-name descname">pair_ids</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.special.pair_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to map two integers to one in a unique and deterministic manner.
Python implementation of Matthew Szudzik’s elegant pairing function (WolframAlpha)</p>
</dd></dl>

<dl class="py function">
<dt id="spt.special.render_trackmap">
<code class="sig-prename descclassname">spt.special.</code><code class="sig-name descname">render_trackmap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">flatyxf_u</span></em>, <em class="sig-param"><span class="n">image_shape</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.special.render_trackmap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="spt.special.split_trajectories">
<code class="sig-prename descclassname">spt.special.</code><code class="sig-name descname">split_trajectories</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">subN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#spt.special.split_trajectories" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Split trajectories into shorter trajectories of length subN. Three new columns are assigned to give track ID:</dt><dd><p>supgroup: Super-group = group column of original
subgroup: Sub-group = New trajectories of length subN or lower
group:    Unique new sub-group ID</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Picked localizations (see picasso.render)</p></li>
<li><p><strong>subN</strong> (<em>int</em>) – Maximum length of sub-trajectories</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Picked localizations (see picasso.render) with three new or modified columns (see above)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>subdf(pandas.DataFrame)</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="contact.html" class="btn btn-neutral float-right" title="Contact" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="modules.html" class="btn btn-neutral float-left" title="API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Florian Stehr

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>